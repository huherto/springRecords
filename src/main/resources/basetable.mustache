package {{baseTablePackageName}};

import org.springframework.jdbc.core.RowMapper;

import javax.sql.DataSource;
{{#baseTableImports}}
{{toString}}
{{/baseTableImports}}

public class {{baseTableClassName}} extends BaseTable<{{concreteRecordClassName}}> {

    private RowMapper<{{concreteRecordClassName}}> rm = DtoRowMapper.newInstance({{concreteRecordClassName}}.class);

    public {{baseTableClassName}}(DataSource dataSource) {
        super(dataSource);
    }

    @Override
    public RowMapper<{{concreteRecordClassName}}> rowMapper() {
        return rm;
    }

    @Override
    public String tableName() {
        return "{{tableName}}";
    }

    {{#primaryKey}}
    public {{concreteRecordClassName}} findObject({{pkMethodParameterList}}) {
        String sql =
            "select * "+
            "from {{tableName}} "+
            "where {{pkSqlCondition}} ";

        return singleResult(sql, {{pkArgumentList}});
    }

    public {{concreteRecordClassName}} fetchObject({{pkMethodParameterList}}) {
        String sql =
            "select * "+
            "from {{tableName}} "+
            "where {{pkSqlCondition}} ";

        return requiredSingleResult(sql, {{pkArgumentList}});
    }

    {{/primaryKey}}

}
